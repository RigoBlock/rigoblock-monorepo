/* eslint-disable */
import { BigNumber } from 'bignumber.js'
import BaseContract from '../../baseContract'

{{#if events}}
export enum {{contractName}}Events {
    {{#each events}}
    {{name}} = '{{name}}',
    {{/each}}
}
{{/if}}

export class {{contractName}} extends BaseContract<{{contractName}}Events> {
  public constructor(web3: any, address: string) {
    const abi = {{{getAbi ctor events methods}}}
    super(web3, address, abi);
  }

  static async createAndValidate(
    web3: any,
    address: string
  ): Promise<{{contractName}}> {
    const contract = new {{contractName}}(web3, address)
    const code = await web3.eth.getCode(address)

    // in case of missing smartcontract, code can be equal to "0x0" or "0x" depending on exact web3 implementation
    // to cover all these cases we just check against the source code length — there won't be any meaningful EVM program in less then 3 chars
    if (code.length < 4) {
      throw new Error(`Contract at ${address} doesn't exist!`);
    }
    return contract;
  }

  public static address: string

  {{#each methods}}
    {{#this.constant}}
  {{> constantFunction contractName=../contractName}}
    {{/this.constant}}
    {{^this.constant}}
  {{> txFunction contractName=../contractName}}
    {{/this.constant}}
  {{/each}}
  {{#if events}}
    {{#each events}}
    {{log this}}
  {{> event contractName=../contractName}}
    {{/each}}
  {{/if}}

  static isDeployed() {
    return !!this.address
  }
}
